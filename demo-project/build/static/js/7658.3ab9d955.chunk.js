"use strict";(self.webpackChunkdemo_project=self.webpackChunkdemo_project||[]).push([[7658],{4726:(e,s,t)=>{t.d(s,{Oe:()=>p,Ow:()=>m,Rn:()=>v,Tu:()=>y,U0:()=>c,WB:()=>h,Y8:()=>f,YZ:()=>d,hA:()=>r,kL:()=>u,pD:()=>i,rW:()=>l,wr:()=>g,x8:()=>j,yA:()=>x});var a=t(2843),n=t(1036),o=t(3447);const l=e=>async s=>{try{s({type:o.bb});const{data:t}=await a.A.get(`/posts/all/${e}`);s({type:o.hj,payload:t})}catch(l){var t,n;s({type:o.WS,payload:null===(t=l.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message})}},i=e=>async s=>{try{s({type:o.Q});const t={headers:{"Content-Type":"multipart/form-data"}},{data:n}=await a.A.post("/posts/create",e,t);s({type:o.C0,payload:n})}catch(l){var t,n;const e=(null===(t=l.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"Something went wrong. Please try again.";s({type:o.Bm,payload:e})}},d=e=>async(s,t)=>{try{s({type:o.mw});const{data:t}=await a.A.post(`/posts/repost/${e}`);s({type:o.mV,payload:t}),n.oR.success("Post reposted successfully")}catch(l){s({type:o.BP,payload:l.response&&l.response.data.message?l.response.data.message:l.message}),n.oR.error("Failed to repost. Please try again.")}},r=e=>async s=>{try{s({type:o.aw});const{data:t}=await a.A.get(`/posts/${e}`);s({type:o.MM,payload:t.post})}catch(t){s({type:o.x5,payload:t.response.data.message})}},c=e=>async s=>{try{s({type:o.jB});const t={headers:{"Content-Type":"application/json"}},{data:n}=await a.A.post("/posts/comment",e,t);s({type:o.vs,payload:n})}catch(l){var t,n;s({type:o.cJ,payload:(null===(t=l.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"An error occurred"})}},m=e=>async s=>{try{s({type:o.wd});const{data:t}=await a.A.get("/posts/comment/all",{params:{id:e}});console.log(t),s({type:o.Qo,payload:t.comments})}catch(l){var t,n;s({type:o.$M,payload:(null===(t=l.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||"An error occurred"})}},p=(e,s,t)=>async(l,i)=>{try{l({type:o.vV});const i={headers:{"Content-Type":"application/json"}},{data:d}=await a.A.post(`/posts/${e}/comment/${s}/reply`,{reply:t},i);l({type:o.X2,payload:d}),n.oR.success("Reply added successfully")}catch(d){l({type:o.Gi,payload:d.response&&d.response.data.message?d.response.data.message:d.message}),n.oR.error(d.response&&d.response.data.message?d.response.data.message:d.message)}},u=e=>async s=>{try{s({type:o.hN});const{data:t}=await a.A.post("/posts/like",{postId:e});s({type:o.FE,payload:t})}catch(n){var t;s({type:o.W7,payload:(null===(t=n.response)||void 0===t?void 0:t.data.message)||n.message})}},v=e=>async s=>{try{s({type:o.fg});const{data:t}=await a.A.post("/posts/unlike",{postId:e});s({type:o.$z,payload:t})}catch(n){var t;s({type:o.gE,payload:(null===(t=n.response)||void 0===t?void 0:t.data.message)||n.message})}},h=e=>async s=>{try{await a.A.post(`/posts/not-interested/${e}`),s({type:"NOT_INTERESTED_SUCCESS",payload:e})}catch(t){console.error(t),s({type:"NOT_INTERESTED_FAIL",payload:t.message})}},y=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return async(n,l)=>{try{n({type:o.AY});const{user:{user:i}}=l(),d={headers:{Authorization:`Bearer ${i.token}`},params:{postId:e,commentId:s,replyId:t}},{data:r}=await a.A.delete("/posts/comment/delete",d);n({type:o.eQ,payload:r.message})}catch(i){n({type:o.$R,payload:i.response&&i.response.data.message?i.response.data.message:i.message})}}},x=()=>e=>{e({type:o.eY})},g=()=>({type:o.c2}),j=()=>e=>{e({type:o.Il})},f=()=>e=>{e({type:o.c2})}},5277:(e,s,t)=>{t.r(s),t.d(s,{default:()=>C});var a=t(5043),n=t(184),o=t(245),l=t(579);const i=e=>{var s,t,d;let{comment:r,addReply:c,updateLikes:m,deleteComment:p}=e;const[u,v]=(0,a.useState)(!1),[h,y]=(0,a.useState)(""),[x,g]=(0,a.useState)(!0);return(0,l.jsxs)("div",{className:"comment",children:[(0,l.jsxs)("div",{className:"comment-header",children:[(0,l.jsxs)("div",{className:"comment-info",children:[(0,l.jsx)("img",{src:r.avatar,alt:"avatar",className:"avatar"}),(0,l.jsx)("span",{className:"text-small fw-bold username",children:r.name}),(0,l.jsx)("span",{className:"timestamp text-small",children:(0,l.jsx)(o.A,{date:r.createdAt})})]}),(0,l.jsxs)("div",{className:"comment-actions-header",children:[r.replies&&r.replies.length>0&&(0,l.jsx)("span",{className:"toggle-children",onClick:()=>g(!x),children:x?(0,l.jsx)(n.UnJ,{}):(0,l.jsx)(n.E5P,{})}),(0,l.jsx)("span",{className:"delete-comment",onClick:()=>p(r._id),children:(0,l.jsx)(n.qbC,{className:"delete-icon"})})]})]}),(0,l.jsx)("div",{className:"comment-body",children:(0,l.jsx)("p",{className:"text-muted ps-4",style:{fontSize:"0.9rem",fontFamily:"cursive"},children:r.comment||r.reply})}),(0,l.jsxs)("div",{className:"comment-actions align-items-center ",children:[(0,l.jsxs)("span",{onClick:()=>m(r._id,"like"),children:[(0,l.jsx)(n.gb0,{})," ",(null===(s=r.likes)||void 0===s?void 0:s.length)||0]}),(0,l.jsxs)("span",{onClick:()=>m(r._id,"dislike"),children:[(0,l.jsx)(n.b7w,{})," ",(null===(t=r.dislikes)||void 0===t?void 0:t.length)||0]}),(0,l.jsxs)("span",{onClick:()=>v(!u),children:[(0,l.jsx)(n.w1Z,{})," Reply"]}),(0,l.jsxs)("span",{children:[(0,l.jsx)(n.Zzu,{})," Share"]})]}),u&&(0,l.jsxs)("div",{className:"reply-section",children:[(0,l.jsx)("textarea",{value:h,onChange:e=>y(e.target.value),placeholder:"Enter your reply...",rows:"3",cols:"50"}),(0,l.jsx)("button",{onClick:()=>{c(r._id,h),y(""),v(!1)},children:"Submit"})]}),x&&(null===r||void 0===r?void 0:r.replies)&&(null===r||void 0===r||null===(d=r.replies)||void 0===d?void 0:d.length)>0&&(0,l.jsx)("div",{className:"comment-children",children:r.replies.map((e=>(0,l.jsx)(i,{comment:e,addReply:c,updateLikes:m,deleteComment:p},e._id)))})]})},d=i,r=e=>{let{comments:s,addReply:t,updateLikes:a,deleteComment:n}=e;return(0,l.jsx)("div",{children:s.map((e=>(0,l.jsx)(d,{comment:e,addReply:t,updateLikes:a,deleteComment:n},e.id)))})};var c=t(3003),m=t(4726),p=t(3216),u=t(5475),v=t(9122),h=t(1036),y=t(921),x=t(1462),g=t(1842),j=t(3447),f=t(4450);const N=e=>{let{postId:s,parentCommentId:t=null}=e;const[n,o]=(0,a.useState)(""),[i,d]=(0,a.useState)(!1),r=(0,c.wA)(),p=(0,a.useRef)(null);(0,f.j)(p,(()=>d(!1)));const{success:u,error:y,loading:N}=(0,c.d4)((e=>e.newComment));(0,a.useEffect)((()=>{y&&(h.oR.error(y.message||"Something went wrong"),r((0,v.x8)())),u&&(h.oR.success("Comment Submitted Successfully"),r({type:j.nm}),o(""))}),[r,u,y]);return(0,l.jsx)("div",{className:"border-top-3 px-2",children:(0,l.jsxs)("div",{className:"bg-white p-2 position-relative",ref:p,children:[i&&(0,l.jsx)("div",{className:"emoji-picker",children:(0,l.jsx)(g.A,{onEmojiSelect:e=>{const s=e.unified.split("-").map((e=>"0x"+e)),t=String.fromCodePoint(...s);o((e=>e+t))}})}),(0,l.jsxs)("form",{className:"d-flex gap-2 justify-center align-items-center text-center",onSubmit:e=>{e.preventDefault();const a=new FormData;a.set("comment",n),a.set("postId",s),t&&a.set("parentCommentId",t),r((0,m.U0)(a))},children:[(0,l.jsx)(x.F2r,{size:35,color:"gold",onClick:()=>{d(!i)}}),(0,l.jsx)("textarea",{name:"",id:"",value:n,onChange:e=>o(e.target.value),placeholder:"Post Your reply..",className:"comment-textarea"}),(0,l.jsx)("span",{className:"gif-span",children:"GIF"}),(0,l.jsx)("button",{className:"btn btn-primary btn-sm",type:"submit",disabled:N,children:N?"Posting...":"Post"})]})]})})};var b=t(9804),w=t(423),k=t(5394);const C=()=>{var e,s,t,o,i,d,x,g,j,f,C,S,A;const{id:R}=(0,p.g)(),E=(0,c.wA)(),{post:I}=(0,c.d4)((e=>e.postDetail)),{loading:M,comments:T,error:O}=(0,c.d4)((e=>e.postComments)),{success:_,error:P}=(0,c.d4)((e=>e.commentDelete)),D=(0,c.d4)((e=>e.user.user)),B=null===D||void 0===D?void 0:D._id,[F,L]=(0,a.useState)(null===D||void 0===D?void 0:D.following.includes(null===I||void 0===I||null===(e=I.postedBy)||void 0===e?void 0:e._id)),[$,U]=(0,a.useState)(null);(0,a.useEffect)((()=>{E((0,m.Ow)(R)),E((0,m.hA)(R)),_&&(h.oR.success("Comment deleted successfully!"),E((0,m.yA)())),P&&(h.oR.error(P),E((0,m.x8)()))}),[E,R,_,P]);const z=null===I||void 0===I||null===(s=I.likes)||void 0===s?void 0:s.includes(B);return(0,l.jsx)("div",{className:"container-fluid comment-container-layer",children:(0,l.jsxs)("div",{className:"container p-4 custom-container ",children:[(0,l.jsx)(u.k2,{to:"home",className:"nav-link",children:(0,l.jsx)(k.LwM,{className:"close-icon"})}),(0,l.jsxs)("div",{className:"row d-flex justify-center align-items-center",children:[(null===I||void 0===I?void 0:I.images)&&(null===I||void 0===I||null===(t=I.images)||void 0===t?void 0:t.length)>0&&(0,l.jsxs)("div",{className:"col-5 comment-image",children:[(0,l.jsx)("div",{className:"thumbnailBox",style:{width:"400px",height:"70vh"},children:(0,l.jsx)("img",{src:I.images[0].url,className:"border border-1 rounded-4",alt:"Content",width:"100%",height:"100%"})}),(0,l.jsxs)("div",{className:"post-actions",children:[(0,l.jsxs)("button",{className:"action-btn like-btn "+(z?"liked":""),children:[z?(0,l.jsx)(n.Mbv,{}):(0,l.jsx)(n.sOK,{}),(0,l.jsx)("span",{className:"action-count",children:null===I||void 0===I||null===(o=I.likes)||void 0===o?void 0:o.length})]}),(0,l.jsxs)("button",{className:"action-btn comment-btn",children:[(0,l.jsx)(n.fK7,{}),(0,l.jsx)("span",{className:"action-count",children:null===I||void 0===I||null===(i=I.comments)||void 0===i?void 0:i.length})]}),(0,l.jsxs)("button",{className:"action-btn repost-btn",children:[(0,l.jsx)(b.nmQ,{}),(0,l.jsx)("span",{className:"action-count",children:null===I||void 0===I?void 0:I.repostCount})]})]})]}),(0,l.jsxs)("div",{className:"col-6  comment-profile",children:[(0,l.jsxs)("div",{className:"user-container d-flex justify-content-between ps-4 p-1",children:[(0,l.jsx)("img",{src:(null===I||void 0===I||null===(d=I.author)||void 0===d?void 0:d.avatar)||(null===I||void 0===I||null===(x=I.postedBy)||void 0===x?void 0:x.avatar),alt:"Author",width:"50",height:"50",className:"img-fluid rounded-circle"}),(0,l.jsxs)("div",{className:"gap-0",children:[(0,l.jsxs)("div",{className:" d-flex justify-content-center align-items-center gap-1",children:[(0,l.jsx)("h5",{className:"text-normal",children:(null===I||void 0===I||null===(g=I.author)||void 0===g?void 0:g.name)||(null===I||void 0===I||null===(j=I.postedBy)||void 0===j?void 0:j.name)||"Unknown Author"}),(0,l.jsx)(w.v_8,{className:"text-primary"}),(0,l.jsx)("span",{className:"text-muted",style:{fontSize:"0.8rem",fontFamily:"cursive"},children:null!==D&&void 0!==D&&D.createdAt?new Date(D.createdAt).toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",month:"short",day:"numeric"}):""})]}),(0,l.jsx)("span",{class:"badge rounded-pill bg-light text-secondary text-muted",children:(null===I||void 0===I||null===(f=I.author)||void 0===f?void 0:f.email)||(null===I||void 0===I||null===(C=I.postedBy)||void 0===C?void 0:C.email)||"Unknown Email"}),(0,l.jsx)("span",{class:"badge rounded-pill bg-light text-secondary text-muted px-2",children:null===I||void 0===I||null===(S=I.author)||void 0===S?void 0:S.username})]}),(0,l.jsx)("div",{children:B===(null===I||void 0===I||null===(A=I.postedBy)||void 0===A?void 0:A._id)?(0,l.jsx)(u.k2,{to:"/me/update",className:"btn-dark rounded-5 btn btn-sm",children:"Edit Profile"}):(0,l.jsx)("button",{onClick:async()=>{var e;await E((0,v.Qp)(null===I||void 0===I||null===(e=I.postedBy)||void 0===e?void 0:e._id,F,B)),L(!F)},className:"btn rounded-5 px-2 btn-sm "+(F?"btn-outline-primary":"btn-outline-danger"),disabled:M,children:F?"Follow":"Following"})})]}),(0,l.jsxs)("div",{className:"mt-2 comment-container ps-4",children:[(null===I||void 0===I?void 0:I.content)&&(0,l.jsx)("p",{className:"mt-2 text-muted",style:{fontSize:"0.8rem",fontFamily:"cursive"},children:I.content}),M?(0,l.jsx)("p",{children:"Loading comments..."}):O?(0,l.jsxs)("p",{children:["Error: ",O]}):(0,l.jsx)(r,{comments:T,addReply:(e,s)=>{E((0,m.Oe)(R,e,s))},updateLikes:(e,s)=>{"like"===s?E((0,y.tT)(R,e)).then((()=>{h.oR.success("Comment liked successfully!")})):"dislike"===s&&E((0,y.Ph)(R,e)).then((()=>{h.oR.success("Comment disliked successfully!")}))},deleteComment:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;E((0,m.Tu)(R,e,s))}})]}),(0,l.jsx)("div",{className:"",children:(0,l.jsx)(N,{postId:R})})]})]})]})})}},245:(e,s,t)=>{t.d(s,{A:()=>v});var a=t(5043);function n(e){const s=new Date(e);if(!Number.isNaN(s.valueOf()))return s;const t=String(e).match(/\d+/g);if(null==t||t.length<=2)return s;{const[e,s,...a]=t.map((e=>parseInt(e))),n=[e,s-1,...a];return new Date(Date.UTC(...n))}}function o(e,s,t){return e+" "+(1!==e?s+"s":s)+" "+t}function l(){return l=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},l.apply(this,arguments)}const i=60,d=60*i,r=24*d,c=7*r,m=30*r,p=365*r,u=()=>Date.now();function v(e){let{date:s,formatter:t=o,component:v="time",live:h=!0,minPeriod:y=0,maxPeriod:x=c,title:g,now:j=u,...f}=e;const[N,b]=(0,a.useState)(j());(0,a.useEffect)((()=>{if(!h)return;const e=(()=>{const e=n(s).valueOf();if(!e)return console.warn("[react-timeago] Invalid Date provided"),0;const t=Math.round(Math.abs(N-e)/1e3),a=t<i?1e3:t<d?1e3*i:t<r?1e3*d:1e3*c,o=Math.min(Math.max(a,1e3*y),1e3*x);return o?setTimeout((()=>{b(j())}),o):0})();return()=>{e&&clearTimeout(e)}}),[s,h,x,y,j,N]);const w=v,k=n(s).valueOf();if(!k)return null;const C=Math.round(Math.abs(N-k)/1e3),S=k<N?"ago":"from now",[A,R]=C<i?[Math.round(C),"second"]:C<d?[Math.round(C/i),"minute"]:C<r?[Math.round(C/d),"hour"]:C<c?[Math.round(C/r),"day"]:C<m?[Math.round(C/c),"week"]:C<p?[Math.round(C/m),"month"]:[Math.round(C/p),"year"],E="undefined"===typeof g?"string"===typeof s?s:n(s).toISOString().substr(0,16).replace("T"," "):g,I="time"===w?{...f,dateTime:n(s).toISOString()}:f,M=o.bind(null,A,R,S);return a.createElement(w,l({},I,{title:E}),t(A,R,S,k,M,j))}}}]);
//# sourceMappingURL=7658.3ab9d955.chunk.js.map